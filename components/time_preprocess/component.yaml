name: Spark Timestamp Prepeocess
description: preprocess the category feature
inputs:
  - {name: dataset_path, type: String, description: 'the path of the dataset'}
  - {name: time_column_name, type: String, description: 'label name'}
  - {name: time_to_columns, type: String, description: 'the path of the preprocessed dataset will be saved!'}
  - {name: out_timestamp_path, type: String, description: 'the path of the preprocessed dataset will be saved!'}

outputs:
  - {name: out_timestamp_path, type: String, description: 'file_out'}
implementation:
  container:
    image: timestamp:default
    command: [python, time_preprocess.py]
    args: [
      --dataset-path,             {inputValue: dataset_path},
      --time-column-name,         {inputValue: time_column_name},
      --time-to-columns,          {inputValue: time_to_columns},
      --out-timestamp-path,       {inputValue: out_timestamp_path},

      --out-timestamp-path-file,  {outputPath: out_timestamp_path},
    ]
